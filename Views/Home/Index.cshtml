@model List<LateNight.Models.Expense>
@{
    Layout = "~/Views/Shared/_Layout.cshtml"; // Ensure this path matches your layout file location
}

<div style="width: 50%; float: left;">
    <h2>Monthly Budget</h2>
    @if (!ViewBag.IsBudgetSet) {
        <form action="/Home/SetBudget" method="post" class="form-horizontal">
            <div class="form-group">
                <label for="budget" class="col-sm-4 control-label">Set Monthly Budget:</label>
                <div class="col-sm-8">
                    <input type="number" id="budget" name="budget" required class="form-control">
                </div>
                <div class="col-sm-offset-4 col-sm-8">
                    <button type="submit" class="btn btn-success">Set Budget</button>
                </div>
            </div>
        </form>
    }
    
    <form action="/Home/AddExpense" method="post" class="form-horizontal">
        <div class="form-group">
            <label for="name" class="col-sm-4 control-label">Expense Name:</label>
            <div class="col-sm-8">
                <input type="text" id="name" name="Name" required class="form-control">
            </div>
        </div>
        <div class="form-group">
            <label for="amount" class="col-sm-4 control-label">Expense Amount:</label>
            <div class="col-sm-8">
                <input type="number" id="amount" name="Amount" required class="form-control">
            </div>
        </div>
        <div class="form-group">
            <div class="col-sm-offset-4 col-sm-8">
                <button type="submit" class="btn btn-success">Submit Expense</button>
            </div>
        </div>
    </form>
    
    
     @if (ViewBag.Budget > 0) {
            <p style="color: green;">Your set budget is $ @ViewBag.Budget</p>
     }
        
    @if (ViewBag.OverBudget > 0) {
        <p style="color: red;">You're $ @ViewBag.OverBudget over your budget</p>
    }
    
    
</div>
<div class="chart-container" style="float: right; width: 400px; height: 400px;">
    <h2>Expenses Pie Chart</h2>
    <canvas id="expensesChart"
            data-labels='@Html.Raw(Newtonsoft.Json.JsonConvert.SerializeObject(Model.Select(e => e.Name)))'
            data-data='@Html.Raw(Newtonsoft.Json.JsonConvert.SerializeObject(Model.Select(e => e.Amount)))'>
    </canvas>
</div>
